import{U as F,r,j as e,bv as le,x as h,a2 as p,aI as B,ax as X,bu as ce,ad as y,G as D,a3 as re,ac as se,a_ as de,Y as he,H as M,ae as q,af as oe,aw as ue,aY as R,$ as J,az as me,a1 as ge,aZ as _,b6 as V,aL as Y,X as Q,aD as ee,bB as te}from"../multikey/multikey.Cv6HG7AM.js";import{a as l,k as ne,q as ae,b as pe,u as fe,r as we,s as G,v as be,w as Ce,M as xe}from"../multikey/multikey.EJ3kMsQf.js";const ve=({isCheck:n,close:m,confirm:a})=>{const{t}=F(),[s,d]=r.useState("text"),[S,v]=r.useState(""),[A,x]=r.useState(!1),[C,f]=r.useState(t("login.pwEmpty")),P=()=>{v(""),x(!1),f(""),d(""),m()},L=r.useCallback(w=>{const z=l.getCache("current");return w==""?(x(!0),f(t("login.pwEmpty")),!1):w!==z.password?(x(!0),f(t("login.incorrect")),!1):(x(!1),f(""),!0)},[t]),k=w=>{const{value:z}=w.target;d("password"),v(w.target.value),L(z)},I=()=>{L(S)&&(v(""),d("text"),a())};return e(re,{children:e(le,{open:n,onClose:P,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:h(D,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,p:2,borderRadius:2,width:{xs:"90%",md:"50%",lg:"30%",xl:"20%"}},children:[e(p,{id:"modal-modal-title",variant:"h6",component:"h2",mb:3,children:t("home.check")}),e(B,{sx:{minWidth:120,width:"100%",mb:3},required:!0,children:e(X,{required:!0,label:t("login.password"),onChange:k,size:"medium",autoComplete:"off",inputMode:"none",variant:"outlined",color:"secondary",type:s,value:S,error:A,fullWidth:!0,helperText:A?C:""})}),h(ce,{children:[e(y,{variant:"outlined",sx:{minWidth:150,lineHeight:2.4},onClick:P,size:"large",children:t("login.cancel")}),e(y,{variant:"filled",sx:{minWidth:150,lineHeight:2.4},onClick:I,size:"large",children:t("login.confirm")})]})]})})})},ye=()=>{const{t:n}=F(),[m,a]=r.useState(null),[t,s]=r.useState(null),[d,S]=r.useState(!1),[v,A]=r.useState(!1),[x,C]=r.useState(""),[f,P]=r.useState(null),L=r.useCallback(c=>{if(c.trim().length<=0){const g={text:n("home.inputAccount"),boo:!0};return P(g),!1}else return P({text:"",boo:!1}),!0},[n]),k=c=>{const{value:u}=c.target;C(u),L(u)},I=()=>{v?S(!0):A(!0)},w=async()=>{const c=L(x),u=l.getCache("hasher"),g=ne.getKeyring(u);if(c){const T=m[m.length-1],O=T.index+1,{privateKey:N}=ae.wallet(T.mnemonic,O),E=ae.publicKey(N),H=g.publicToID(E),i=ne.addressString(H),o={id:l.uuid(),index:O,selectId:t.selectId,name:x,mnemonic:T.mnemonic,password:T.password,networkId:t.networkId,privateKey:N,publicKey:E,account:i,isShow:!0,isLogin:!1};m.push(o),a(()=>[...m]),l.setCache(`${t.mnemonic}-${t.selectId}`,m),A(!1),C("")}},z=(c,u)=>{u!=="clickaway"&&S(!1)},W=async c=>{if(m){const u=m.map(g=>(g.id===c&&(g.isShow=!1),g));a(()=>[...u]),l.setCache(`${t.mnemonic}-${t.selectId}`,u)}},$=async c=>{if(m){const u=m.map(g=>(g.id===c&&(g.isShow=!0),g));a(()=>[...u]),l.setCache(`${t.mnemonic}-${t.selectId}`,u)}};return r.useEffect(()=>{(()=>{const u=l.getCache("current");try{const g=l.getCache(`${u.mnemonic}-${u.selectId}`);a(g),s(u)}catch{}})()},[]),h(D,{mb:3,children:[e(p,{variant:"h6",mb:1,children:n("login.loacl")}),e(p,{variant:"body2",mb:3,children:n("login.now")}),e(he,{sx:{maxHeight:"300px",overflowY:"auto",width:{md:"80%",sm:"100%"}},children:m?m.map(c=>h(se,{sx:{mb:2,p:0},children:[e(de,{title:c.name,placement:"bottom-start",children:e(p,{width:"60%",variant:"body2",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"},children:c.name})}),c.isLogin?e(y,{disabled:c.isLogin,variant:"text",sx:{mx:1,minWidth:150,lineHeight:2.4},size:"large",children:n("manage.current")}):c.isShow?e(y,{variant:"outlined",sx:{mx:1,minWidth:150,lineHeight:2.4},onClick:()=>{W(c.id)},size:"large",children:n("manage.close")}):e(y,{sx:{mx:1,minWidth:150,lineHeight:2.4},variant:"filled",onClick:()=>{$(c.id)},size:"large",children:n("manage.use")})]},c.id)):""}),v?e(B,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:1},children:h(M,{direction:"row",children:[e(X,{sx:{width:"60%"},placeholder:n("home.inputAccount"),size:"medium",fullWidth:!0,autoComplete:"off",value:x,variant:"standard",onChange:k,error:f?f.boo:!1,helperText:f?f.text:""}),e(y,{variant:"outlined",sx:{mx:1,minWidth:150,lineHeight:2.4},onClick:w,size:"large",children:n("login.confirm")})]})}):"",e(D,{children:e(y,{variant:"filled",sx:{mx:1,minWidth:150,lineHeight:2.4},onClick:I,size:"large",children:n("manage.add")})}),e(oe,{open:d,autoHideDuration:3e3,onClose:z,anchorOrigin:{vertical:"top",horizontal:"center"},children:e(q,{onClose:z,severity:"warning",sx:{width:"100%"},children:n("manage.create")})})]})},Pe=window,Se=()=>{const{i18n:n}=F(),m=pe(),a=fe(we),t=async s=>{n.changeLanguage(s.value),await m(be(s.value)),await m(Ce(s.value)),localStorage.setItem("lang",s.value),Pe.location.reload()};return e(re,{children:e(ue,{freeSolo:!0,id:"language-change",sx:{width:300},size:"medium",value:G.find(s=>s.value===a),options:G,getOptionLabel:s=>s.label,onChange:(s,d)=>{t(d)},disableClearable:!0,clearIcon:"",renderInput:s=>{var d;return e(X,{variant:"outlined",className:"team-search",...s,InputProps:{...s.InputProps,type:"search",startAdornment:e(R,{position:"start",children:e(J,{alt:"Remy Sharp",src:(d=G.find(S=>S.value===a))==null?void 0:d.logo,sx:{width:25,height:25}})})}})},renderOption:(s,d)=>h(se,{...s,children:[a===d.value?e(me,{color:"success"}):e(p,{fontSize:20,width:20}),e(J,{alt:"Remy Sharp",src:d.logo,sx:{width:25,height:25}}),e(ge,{primary:d.label,sx:{ml:1}})]})})})},ke=(n,m)=>{const{t:a}=F(),{success:t}=n,[s,d]=r.useState(null),[S,v]=r.useState(null),[A,x]=r.useState(""),[C,f]=r.useState(null),[P,L]=r.useState(""),[k,I]=r.useState(null),[w,z]=r.useState(""),[W,$]=r.useState(null),c=r.useCallback(i=>{if(i.trim().length<=0){const b={text:a("manage.oldPassword"),boo:!0};return f(b),!1}else if(i!==(s==null?void 0:s.password)){const b={text:a("manage.oldError"),boo:!0};return f(b),!1}else return f({text:"",boo:!1}),!0},[s==null?void 0:s.password,a]),u=i=>{const{value:o}=i.target;c(o),x(o)},g=r.useCallback(i=>{const o=i.trim();if(o.length<=0){const b={text:a("manage.inputPassword"),boo:!0};return I(b),!1}else if(o.length>50){const b={text:a("manage.longPassword"),boo:!0};return I(b),!1}else return I({text:"",boo:!1}),!0},[a]),T=i=>{const{value:o}=i.target;g(o),L(o)},O=r.useCallback(i=>{if(i.trim().length<=0){const b={text:a("manage.againPassword"),boo:!0};return $(b),!1}else if(i!==P){const b={text:a("manage.againNot"),boo:!0};return $(b),!1}else return $({text:"",boo:!1}),!0},[P,a]),N=i=>{const{value:o}=i.target;O(o),z(o)},E=()=>{x(""),L(""),z(""),$(null),I(null),f(null)};r.useImperativeHandle(m,()=>({handleCancel:E}));const H=()=>{const i=c(A),o=g(P),b=O(w),Z=l.getCache("accountList");if(i&&o&&b){d({...s,password:w});const ie=Z.map(K=>(K.id===s.selectId&&(K.password=w),K));if(l.setCache("accountList",ie),l.setCache("current",{...s,password:w}),S){const K=S.map(j=>(j.privateKey&&(j.password=w),j));v(()=>[...K]),l.setCache(`${s.mnemonic}-${s.selectId}`,K)}t()}};return r.useEffect(()=>{(()=>{const o=l.getCache("current"),b=l.getCache(`${o.mnemonic}-${o.selectId}`);l.getCache("accountList");try{d(o),v(b)}catch{}})()},[]),h(D,{mb:3,children:[e(p,{variant:"h6",mb:1,children:a("manage.safety")}),e(p,{variant:"body2",mb:2,children:a("manage.setting")}),h(D,{sx:{width:{md:"60%",sm:"100%"}},children:[h(B,{fullWidth:!0,sx:{mb:2},children:[e(_,{htmlFor:"outlined-adornment-oldPassword",required:!0,sx:{fontSize:16},error:C?C.boo:!1,children:a("manage.check")}),e(V,{fullWidth:!0,placeholder:a("manage.old"),size:"medium",autoComplete:"off",type:"password",value:A,id:"outlined-adornment-oldPassword",onChange:u,startAdornment:e(R,{position:"start"}),label:a("manage.check"),error:C?C.boo:!1}),e(Y,{error:!0,children:C?C.text:""})]}),h(B,{fullWidth:!0,sx:{mb:2},children:[e(_,{htmlFor:"outlined-adornment-newPassword",required:!0,sx:{fontSize:16},error:k?k.boo:!1,children:a("manage.newPassword")}),e(V,{fullWidth:!0,placeholder:a("manage.new"),size:"medium",autoComplete:"off",type:"password",value:P,id:"outlined-adornment-newPassword",onChange:T,startAdornment:e(R,{position:"start"}),label:a("manage.newPassword"),error:k?k.boo:!1}),e(Y,{error:!0,children:k?k.text:""})]}),h(B,{fullWidth:!0,sx:{mb:2},children:[e(_,{htmlFor:"outlined-adornment-againPassword",required:!0,sx:{fontSize:16},error:W?W.boo:!1,children:a("manage.again")}),e(V,{fullWidth:!0,placeholder:a("manage.new"),size:"medium",autoComplete:"off",type:"password",value:w,id:"outlined-adornment-againPassword",onChange:N,startAdornment:e(R,{position:"start"}),label:a("manage.again"),error:W?W.boo:!1}),e(Y,{error:!0,children:W?W.text:""})]}),h(M,{direction:"row",justifyContent:"space-around",children:[e(y,{variant:"outlined",onClick:E,sx:{minWidth:150,lineHeight:2.4},size:"large",children:a("login.cancel")}),e(y,{variant:"filled",onClick:H,sx:{minWidth:150,lineHeight:2.4},size:"large",children:a("login.confirm")})]})]})]})},Ie=r.forwardRef(ke),U=window,ze=()=>{const{t:n}=F(),[m,a]=r.useState(!1),[t,s]=r.useState(null),[d,S]=r.useState(!1),[v,A]=r.useState(!1),[x,C]=r.useState(!1),[f,P]=r.useState("mnemonic"),[L,k]=r.useState(n("login.cody")),I=r.useRef(),w=()=>{a(!1),I.current&&I.current.handleCancel()},z=()=>{P("mnemonic"),!x&&!v&&C(!0),v&&A(!1)},W=()=>{C(!1)},$=()=>{P("private"),!x&&!d&&C(!0),d&&S(!1)},c=()=>{a(!0),k(n("manage.success")),U.location.reload()},u=()=>{const H="privateKey.txt",i=new Blob([t.privateKey],{type:"text/plain;charset=utf-8"});te.saveAs(i,H)},g=()=>{const H="mnemonic.txt",i=new Blob([t.mnemonic],{type:"text/plain;charset=utf-8"});te.saveAs(i,H)};r.useEffect(()=>{(()=>{const i=l.getCache("current");try{s(i)}catch{}})()},[]);const T=()=>{if(l.removeCacheToken("token"),l.removeCache("teamSelect"),t!=null&&t.mnemonic){const i=(l.getCache(`${t.mnemonic}-${t.selectId}`)||[]).map(o=>(o.index===0?o.isLogin=!0:o.isLogin=!1,o));l.setCache(`${t.mnemonic}-${t.selectId}`,i)}U.location.href="/login"},O=()=>{P("cleanAccount"),x||C(!0)},N=()=>{const i=(l.getCache("accountList")||[]).filter(o=>o.id!==t.selectId);l.setCache("accountList",i),l.removeCacheToken("token"),t!=null&&t.mnemonic&&l.removeCache(`${t.mnemonic}-${t.selectId}`),U.location.href="/login"},E=()=>{if(C(!1),f==="mnemonic")return A(!0),!1;if(f==="private")return S(!0),!1;f==="cleanAccount"&&N()};return h(xe,{children:[e(p,{variant:"h5",mb:3,children:n("nav.manage")}),t&&t.mnemonic?e(ye,{}):"",e(Ie,{ref:I,success:c}),t&&t.mnemonic?h(D,{mb:2,children:[e(p,{variant:"h6",mb:1,children:n("manage.phrase")}),e(p,{variant:"body2",mb:2,children:n("manage.custody")}),v?e(M,{direction:"row",children:h(q,{severity:"success",sx:{mb:2,display:"flex",alignItems:"center"},children:[t.mnemonic,e(Q,{"aria-label":"ContentCopyIcon",onClick:()=>{a(!0),l.copyToClipboard(t.mnemonic),k(n("login.cody"))},size:"medium",children:e(ee,{})})]})}):"",h(M,{direction:"row",children:[e(y,{variant:"filled",onClick:z,sx:{minWidth:150,lineHeight:2.4},size:"large",children:n(v?"manage.hide":"manage.show")}),v?e(y,{variant:"filled",onClick:g,sx:{mx:5,minWidth:150},size:"large",children:n("manage.import")}):""]})]}):"",h(D,{mb:2,children:[e(p,{variant:"h6",mb:1,children:n("manage.private")}),e(p,{variant:"body2",mb:2,children:n("manage.custodyKey")}),d?e(M,{direction:"row",children:h(q,{severity:"success",sx:{mb:2,display:"flex",alignItems:"center"},children:[t.privateKey,e(Q,{"aria-label":"ContentCopyIcon",onClick:()=>{a(!0),l.copyToClipboard(t.privateKey)},size:"medium",children:e(ee,{})})]})}):"",h(M,{direction:"row",children:[e(y,{variant:"filled",onClick:$,sx:{minWidth:150,lineHeight:2.4},size:"large",children:n(d?"manage.hidePrivate":"manage.showPrivate")}),d?e(y,{variant:"filled",onClick:u,sx:{mx:5,minWidth:150,lineHeight:2.4},size:"large",children:n("manage.import")}):""]})]}),h(D,{mb:3,children:[e(p,{variant:"h6",mb:2,children:n("manage.language")}),e(p,{variant:"body2",mb:2,children:n("manage.select")}),e(Se,{})]}),h(D,{mb:3,children:[e(p,{variant:"h6",mb:2,children:n("manage.help")}),e(p,{variant:"body2",mb:2,children:n("manage.user")})]}),h(D,{mb:3,children:[e(p,{variant:"h6",mb:2,children:n("manage.about")}),e(p,{variant:"body2",mb:2,children:n("manage.open")})]}),h(D,{mb:3,children:[e(y,{variant:"filled",sx:{mb:2,minWidth:150,lineHeight:2.4},onClick:O,size:"large",children:n("manage.clean")}),e(p,{variant:"body2",mb:2,children:n("manage.all")})]}),e(D,{mb:3,children:e(y,{variant:"filled",sx:{minWidth:150,lineHeight:2.4},onClick:T,size:"large",children:n("exit")})}),e(oe,{anchorOrigin:{vertical:"top",horizontal:"center"},open:m,onClose:w,autoHideDuration:2e3,children:e(q,{onClose:w,severity:"success",variant:"filled",sx:{width:"100%"},children:L})}),e(ve,{isCheck:x,close:W,confirm:E})]})};export{ze as Component};
