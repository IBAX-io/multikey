import{as as le,J as B,r as s,j as e,by as ce,x as d,M as w,av as F,_ as G,a9 as M,ac as y,O as z,Y as Q,a4 as oe,aS as de,am as he,ae as _,af as ie,Z as ue,$ as q,K as ee,a3 as me,a2 as ge,aR as V,ba as Y,ay as J,U as te,aa as ne,bE as ae}from"../multikey/multikey.BhREcByE.js";import{a as o,k as re,q as se,b as pe,u as fe,r as we,s as U,v as be,w as Ce,M as ve}from"../multikey/multikey.PuU20_-i.js";const xe=({isCheck:n,close:m,confirm:r})=>{const t=le(),{t:a}=B(),[h,S]=s.useState("text"),[k,D]=s.useState(""),[P,g]=s.useState(!1),[v,b]=s.useState(a("login.pwEmpty")),L=()=>{D(""),g(!1),b(""),S(""),m()},I=s.useCallback(C=>{const x=o.getCache("current");return C==""?(g(!0),b(a("login.pwEmpty")),!1):C!==x.password?(g(!0),b(a("login.incorrect")),!1):(g(!1),b(""),!0)},[a]),W=C=>{const{value:x}=C.target;S("password"),D(C.target.value),I(x)},A=()=>{I(k)&&(D(""),S("text"),r())};return e(Q,{children:e(ce,{open:n,onClose:L,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:d(z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:t.palette.container.main,boxShadow:24,p:2,borderRadius:2,minWidth:460,maxWidth:600,width:{xs:"90%",md:"50%",lg:"30%",xl:"20%"}},children:[e(w,{id:"modal-modal-title",variant:"h6",component:"h2",mb:3,children:a("home.check")}),e(F,{sx:{minWidth:120,width:"100%",mb:3},required:!0,children:e(G,{required:!0,label:a("login.password"),onChange:W,size:"medium",autoComplete:"off",inputMode:"none",variant:"outlined",color:"secondary",type:h,value:k,error:P,fullWidth:!0,helperText:P?v:""})}),d(M,{direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(y,{variant:"outlined",onClick:L,size:"large",children:a("login.cancel")}),e(y,{variant:"filled",onClick:A,size:"large",children:a("login.confirm")})]})]})})})},ye=()=>{const{t:n}=B(),[m,r]=s.useState(null),[t,a]=s.useState(null),[h,S]=s.useState(!1),[k,D]=s.useState(!1),[P,g]=s.useState(""),[v,b]=s.useState(null),L=s.useCallback(c=>{if(c.trim().length<=0){const p={text:n("home.inputAccount"),boo:!0};return b(p),!1}else return b({text:"",boo:!1}),!0},[n]),I=c=>{const{value:u}=c.target;g(u),L(u)},W=()=>{k?S(!0):D(!0)},A=async()=>{const c=L(P),u=o.getCache("hasher"),p=re.getKeyring(u);if(c){const T=m[m.length-1],O=T.index+1,{privateKey:N}=se.wallet(T.mnemonic,O),E=se.publicKey(N),j=p.publicToID(E),f=re.addressString(j),i={id:o.uuid(),index:O,selectId:t.selectId,name:P,mnemonic:T.mnemonic,password:T.password,networkId:t.networkId,privateKey:N,publicKey:E,account:f,isShow:!0,isLogin:!1};m.push(i),r(()=>[...m]),o.setCache(`${t.mnemonic}-${t.selectId}`,m),D(!1),g("")}},C=(c,u)=>{u!=="clickaway"&&S(!1)},x=async c=>{if(m){const u=m.map(p=>(p.id===c&&(p.isShow=!1),p));r(()=>[...u]),o.setCache(`${t.mnemonic}-${t.selectId}`,u)}},$=async c=>{if(m){const u=m.map(p=>(p.id===c&&(p.isShow=!0),p));r(()=>[...u]),o.setCache(`${t.mnemonic}-${t.selectId}`,u)}};return s.useEffect(()=>{(()=>{const u=o.getCache("current");try{const p=o.getCache(`${u.mnemonic}-${u.selectId}`);r(p),a(u)}catch{}})()},[]),d(z,{mb:3,children:[e(w,{variant:"h6",mb:1,children:n("login.loacl")}),e(w,{variant:"body2",mb:3,children:n("login.now")}),e(he,{sx:{maxHeight:"300px",overflowY:"auto",width:{md:"80%",sm:"100%"}},children:m?m.map(c=>d(oe,{sx:{mb:2,p:0},children:[e(de,{title:c.name,placement:"bottom-start",children:e(w,{width:"60%",variant:"body2",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"},children:c.name})}),c.isLogin?e(y,{disabled:c.isLogin,variant:"text",sx:{mx:1,minWidth:150,lineHeight:2.4},size:"large",children:n("manage.current")}):c.isShow?e(y,{variant:"outlined",sx:{mx:1,minWidth:150,lineHeight:2.4},onClick:()=>{x(c.id)},size:"large",children:n("manage.close")}):e(y,{sx:{mx:1,minWidth:150,lineHeight:2.4},variant:"filled",onClick:()=>{$(c.id)},size:"large",children:n("manage.use")})]},c.id)):""}),k?e(F,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:1},children:d(M,{direction:"row",children:[e(G,{sx:{width:"60%"},placeholder:n("home.inputAccount"),size:"medium",fullWidth:!0,autoComplete:"off",value:P,variant:"standard",onChange:I,error:v?v.boo:!1,helperText:v?v.text:""}),e(y,{variant:"outlined",sx:{mx:1,minWidth:150,lineHeight:2.4},onClick:A,size:"large",children:n("login.confirm")})]})}):"",e(z,{children:e(y,{variant:"filled",sx:{mx:1,minWidth:150,lineHeight:2.4},onClick:W,size:"large",children:n("manage.add")})}),e(ie,{open:h,autoHideDuration:3e3,onClose:C,anchorOrigin:{vertical:"top",horizontal:"center"},children:e(_,{onClose:C,severity:"warning",sx:{width:"100%"},children:n("manage.create")})})]})},Se=window,ke=()=>{const{i18n:n}=B(),m=pe(),r=fe(we),t=async a=>{n.changeLanguage(a.value),await m(be(a.value)),await m(Ce(a.value)),localStorage.setItem("lang",a.value),Se.location.reload()};return e(Q,{children:e(ue,{freeSolo:!0,id:"language-change",sx:{width:300},size:"medium",value:U.find(a=>a.value===r),options:U,getOptionLabel:a=>a.label,onChange:(a,h)=>{t(h)},disableClearable:!0,clearIcon:"",renderInput:a=>{var h;return e(G,{variant:"outlined",className:"team-search",...a,InputProps:{...a.InputProps,type:"search",startAdornment:e(q,{position:"start",children:e(ee,{alt:"Remy Sharp",src:(h=U.find(S=>S.value===r))==null?void 0:h.logo,sx:{width:25,height:25}})})}})},renderOption:(a,h)=>d(oe,{...a,children:[r===h.value?e(me,{color:"success"}):e(w,{fontSize:20,width:20}),e(ee,{alt:"Remy Sharp",src:h.logo,sx:{width:25,height:25}}),e(ge,{primary:h.label,sx:{ml:1}})]})})})},Pe=(n,m)=>{const{t:r}=B(),{success:t}=n,[a,h]=s.useState(null),[S,k]=s.useState(null),[D,P]=s.useState(""),[g,v]=s.useState(null),[b,L]=s.useState(""),[I,W]=s.useState(null),[A,C]=s.useState(""),[x,$]=s.useState(null),c=s.useCallback(f=>{if(f.trim().length<=0){const l={text:r("manage.oldPassword"),boo:!0};return v(l),!1}else if(f!==(a==null?void 0:a.password)){const l={text:r("manage.oldError"),boo:!0};return v(l),!1}else return v({text:"",boo:!1}),!0},[a==null?void 0:a.password,r]),u=f=>{const{value:i}=f.target;c(i),P(i)},p=s.useCallback(f=>{const i=f.trim();if(i.length<=0){const l={text:r("manage.inputPassword"),boo:!0};return W(l),!1}else if(i.length>50){const l={text:r("manage.longPassword"),boo:!0};return W(l),!1}else return W({text:"",boo:!1}),!0},[r]),T=f=>{const{value:i}=f.target;p(i),L(i)},O=s.useCallback(f=>{if(f.trim().length<=0){const l={text:r("manage.againPassword"),boo:!0};return $(l),!1}else if(f!==b){const l={text:r("manage.againNot"),boo:!0};return $(l),!1}else return $({text:"",boo:!1}),!0},[b,r]),N=f=>{const{value:i}=f.target;O(i),C(i)},E=()=>{P(""),L(""),C(""),$(null),W(null),v(null)};s.useImperativeHandle(m,()=>({handleCancel:E}));const j=()=>{const f=c(D),i=p(b),l=O(A),H=o.getCache("accountList");if(f&&i&&l){h({...a,password:A});const X=H.map(K=>(K.id===a.selectId&&(K.password=A),K));if(o.setCache("accountList",X),o.setCache("current",{...a,password:A}),S){const K=S.map(R=>(R.privateKey&&(R.password=A),R));k(()=>[...K]),o.setCache(`${a.mnemonic}-${a.selectId}`,K)}t()}};return s.useEffect(()=>{(()=>{const i=o.getCache("current"),l=o.getCache(`${i.mnemonic}-${i.selectId}`);o.getCache("accountList");try{h(i),k(l)}catch{}})()},[]),d(z,{mb:3,children:[e(w,{variant:"h6",mb:1,children:r("manage.safety")}),e(w,{variant:"body2",mb:2,children:r("manage.setting")}),d(z,{sx:{width:{md:"60%",sm:"100%"}},children:[d(F,{fullWidth:!0,sx:{mb:2},children:[e(V,{htmlFor:"outlined-adornment-oldPassword",required:!0,sx:{fontSize:16},error:g?g.boo:!1,children:r("manage.check")}),e(Y,{fullWidth:!0,placeholder:r("manage.old"),size:"medium",autoComplete:"off",type:"password",value:D,id:"outlined-adornment-oldPassword",onChange:u,startAdornment:e(q,{position:"start"}),label:r("manage.check"),error:g?g.boo:!1}),e(J,{error:!0,children:g?g.text:""})]}),d(F,{fullWidth:!0,sx:{mb:2},children:[e(V,{htmlFor:"outlined-adornment-newPassword",required:!0,sx:{fontSize:16},error:I?I.boo:!1,children:r("manage.newPassword")}),e(Y,{fullWidth:!0,placeholder:r("manage.new"),size:"medium",autoComplete:"off",type:"password",value:b,id:"outlined-adornment-newPassword",onChange:T,startAdornment:e(q,{position:"start"}),label:r("manage.newPassword"),error:I?I.boo:!1}),e(J,{error:!0,children:I?I.text:""})]}),d(F,{fullWidth:!0,sx:{mb:2},children:[e(V,{htmlFor:"outlined-adornment-againPassword",required:!0,sx:{fontSize:16},error:x?x.boo:!1,children:r("manage.again")}),e(Y,{fullWidth:!0,placeholder:r("manage.new"),size:"medium",autoComplete:"off",type:"password",value:A,id:"outlined-adornment-againPassword",onChange:N,startAdornment:e(q,{position:"start"}),label:r("manage.again"),error:x?x.boo:!1}),e(J,{error:!0,children:x?x.text:""})]}),d(M,{direction:"row",justifyContent:"space-around",children:[e(y,{variant:"outlined",onClick:E,sx:{minWidth:150,lineHeight:2.4},size:"large",children:r("login.cancel")}),e(y,{variant:"filled",onClick:j,sx:{minWidth:150,lineHeight:2.4},size:"large",children:r("login.confirm")})]})]})]})},Ie=s.forwardRef(Pe),Z=window,ze=()=>{const{t:n}=B(),[m,r]=s.useState(!1),[t,a]=s.useState(null),[h,S]=s.useState(!1),[k,D]=s.useState(!1),[P,g]=s.useState(!1),[v,b]=s.useState("mnemonic"),[L,I]=s.useState(n("login.cody")),[W,A]=s.useState(""),C=s.useRef(),x=()=>{r(!1),C.current&&C.current.handleCancel()},$=()=>{b("mnemonic"),!P&&!k&&g(!0),k&&D(!1)},c=()=>{g(!1)},u=()=>{b("private"),!P&&!h&&g(!0),h&&S(!1)},p=()=>{r(!0),I(n("manage.success")),Z.location.reload()},T=()=>{const i="privateKey.txt",l=new Blob([t.privateKey],{type:"text/plain;charset=utf-8"});ae.saveAs(l,i)},O=()=>{const i="mnemonic.txt";o.setCache(`${t.mnemonic}`,t.mnemonic);const l=new Blob([t.mnemonic],{type:"text/plain;charset=utf-8"});ae.saveAs(l,i)};s.useEffect(()=>{(()=>{const l=o.getCache("current"),H=o.getCacheToken("type");try{a(l),A(H)}catch{}})()},[]);const N=()=>{if(o.removeCacheToken("token"),o.removeCacheToken("type"),o.removeCache("teamSelect"),t!=null&&t.mnemonic){const l=(o.getCache(`${t.mnemonic}-${t.selectId}`)||[]).map(H=>(H.index===0?H.isLogin=!0:H.isLogin=!1,H));o.setCache(`${t.mnemonic}-${t.selectId}`,l)}Z.location.href="/login"},E=()=>{b("cleanAccount"),P||g(!0)},j=()=>{const i=o.getCache("accountList")||[];o.removeCacheToken("token"),o.removeCacheToken("type");const l=i.filter(H=>H.id!==t.selectId);o.setCache("accountList",l),t!=null&&t.mnemonic&&o.removeCache(`${t.mnemonic}-${t.selectId}`),Z.location.href="/login"},f=()=>{if(g(!1),v==="mnemonic")return D(!0),!1;if(v==="private")return S(!0),!1;v==="cleanAccount"&&j()};return d(ve,{children:[W!=="jutkey_connect"?d(Q,{children:[e(w,{variant:"h5",mb:3,children:n("nav.manage")}),t&&t.mnemonic?e(ye,{}):"",e(Ie,{ref:C,success:p}),t&&t.mnemonic?d(z,{mb:2,children:[e(w,{variant:"h6",mb:1,children:n("manage.phrase")}),e(w,{variant:"body2",mb:2,children:n("manage.custody")}),k?e(M,{direction:"row",children:d(_,{severity:"success",sx:{mb:2,display:"flex",alignItems:"center"},children:[t.mnemonic,e(te,{color:"primary","aria-label":"ContentCopyIcon",onClick:()=>{r(!0),o.copyToClipboard(t.mnemonic),I(n("login.cody")),o.setCache(`${t.mnemonic}`,t.mnemonic)},size:"medium",children:e(ne,{})})]})}):"",d(M,{direction:"row",children:[e(y,{variant:"filled",onClick:$,sx:{minWidth:150,lineHeight:2.4},size:"large",children:n(k?"manage.hide":"manage.show")}),k?e(y,{variant:"filled",onClick:O,sx:{mx:5,minWidth:150},size:"large",children:n("manage.import")}):""]})]}):"",d(z,{mb:2,children:[e(w,{variant:"h6",mb:1,children:n("manage.private")}),e(w,{variant:"body2",mb:2,children:n("manage.custodyKey")}),h?e(M,{direction:"row",children:d(_,{severity:"success",sx:{mb:2,display:"flex",alignItems:"center"},children:[t.privateKey,e(te,{color:"primary","aria-label":"ContentCopyIcon",onClick:()=>{r(!0),o.copyToClipboard(t.privateKey)},size:"medium",children:e(ne,{})})]})}):"",d(M,{direction:"row",children:[e(y,{variant:"filled",onClick:u,sx:{minWidth:150,lineHeight:2.4},size:"large",children:n(h?"manage.hidePrivate":"manage.showPrivate")}),h?e(y,{variant:"filled",onClick:T,sx:{mx:5,minWidth:150,lineHeight:2.4},size:"large",children:n("manage.import")}):""]})]})]}):"",d(z,{mb:3,children:[e(w,{variant:"h6",mb:2,children:n("manage.language")}),e(w,{variant:"body2",mb:2,children:n("manage.select")}),e(ke,{})]}),d(z,{mb:3,children:[e(w,{variant:"h6",mb:2,children:n("manage.help")}),e(w,{variant:"body2",mb:2,children:n("manage.user")})]}),d(z,{mb:3,children:[e(w,{variant:"h6",mb:2,children:n("manage.about")}),e(w,{variant:"body2",mb:2,children:n("manage.open")})]}),d(z,{mb:3,children:[e(y,{variant:"filled",sx:{mb:2,minWidth:150,lineHeight:2.4},onClick:E,size:"large",children:n("manage.clean")}),e(w,{variant:"body2",mb:2,children:n("manage.all")})]}),e(z,{mb:3,children:e(y,{variant:"filled",sx:{minWidth:150,lineHeight:2.4},onClick:N,size:"large",children:n("nav.exit")})}),e(ie,{anchorOrigin:{vertical:"top",horizontal:"center"},open:m,onClose:x,autoHideDuration:2e3,children:e(_,{onClose:x,severity:"success",variant:"filled",sx:{width:"100%"},children:L})}),e(xe,{isCheck:P,close:c,confirm:f})]})};export{ze as Component};
