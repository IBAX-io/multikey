import{U as F,r,j as e,bv as ie,x as h,a2 as p,aI as B,aw as X,bu as ce,aD as y,G as D,a3 as re,ac as se,a_ as de,Y as he,H as M,ad as q,ae as oe,av as ue,aY as R,$ as J,ay as me,a1 as ge,aZ as _,b6 as V,aL as Y,X as Q,aC as ee,bB as te}from"../multikey/multikey.B-gp-w2q.js";import{a as i,k as ae,q as ne,b as pe,u as fe,r as we,s as G,v as be,w as Ce,M as xe}from"../multikey/multikey.DDolodBD.js";const ve=({isCheck:a,close:m,confirm:n})=>{const{t}=F(),[s,d]=r.useState("text"),[S,v]=r.useState(""),[A,x]=r.useState(!1),[C,f]=r.useState(t("login.pwEmpty")),P=()=>{v(""),x(!1),f(""),d(""),m()},W=r.useCallback(w=>{const z=i.getCache("current");return w==""?(x(!0),f(t("login.pwEmpty")),!1):w!==z.password?(x(!0),f(t("login.incorrect")),!1):(x(!1),f(""),!0)},[t]),k=w=>{const{value:z}=w.target;d("password"),v(w.target.value),W(z)},I=()=>{W(S)&&(v(""),d("text"),n())};return e(re,{children:e(ie,{open:a,onClose:P,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:h(D,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",boxShadow:24,p:2,borderRadius:2,width:{xs:"90%",md:"50%",lg:"30%",xl:"20%"}},children:[e(p,{id:"modal-modal-title",variant:"h6",component:"h2",mb:3,children:t("home.check")}),e(B,{sx:{minWidth:120,width:"100%",mb:3},required:!0,children:e(X,{required:!0,label:t("login.password"),onChange:k,size:"medium",autoComplete:"off",inputMode:"none",variant:"outlined",color:"secondary",type:s,value:S,error:A,fullWidth:!0,helperText:A?C:""})}),h(ce,{children:[e(y,{onClick:P,size:"large",children:t("login.cancel")}),e(y,{onClick:I,size:"large",children:t("login.confirm")})]})]})})})},ye=()=>{const{t:a}=F(),[m,n]=r.useState(null),[t,s]=r.useState(null),[d,S]=r.useState(!1),[v,A]=r.useState(!1),[x,C]=r.useState(""),[f,P]=r.useState(null),W=r.useCallback(c=>{if(c.trim().length<=0){const g={text:a("home.inputAccount"),boo:!0};return P(g),!1}else return P({text:"",boo:!1}),!0},[a]),k=c=>{const{value:u}=c.target;C(u),W(u)},I=()=>{v?S(!0):A(!0)},w=async()=>{const c=W(x),u=i.getCache("hasher"),g=ae.getKeyring(u);if(c){const O=m[m.length-1],H=O.index+1,{privateKey:N}=ne.wallet(O.mnemonic,H),E=ne.publicKey(N),L=g.publicToID(E),l=ae.addressString(L),o={id:i.uuid(),index:H,selectId:t.selectId,name:x,mnemonic:O.mnemonic,password:O.password,networkId:t.networkId,privateKey:N,publicKey:E,account:l,isShow:!0,isLogin:!1};m.push(o),n(()=>[...m]),i.setCache(`${t.mnemonic}-${t.selectId}`,m),A(!1),C("")}},z=(c,u)=>{u!=="clickaway"&&S(!1)},$=async c=>{if(m){const u=m.map(g=>(g.id===c&&(g.isShow=!1),g));n(()=>[...u]),i.setCache(`${t.mnemonic}-${t.selectId}`,u)}},T=async c=>{if(m){const u=m.map(g=>(g.id===c&&(g.isShow=!0),g));n(()=>[...u]),i.setCache(`${t.mnemonic}-${t.selectId}`,u)}};return r.useEffect(()=>{(()=>{const u=i.getCache("current");try{const g=i.getCache(`${u.mnemonic}-${u.selectId}`);n(g),s(u)}catch{}})()},[]),h(D,{mb:3,children:[e(p,{variant:"h6",mb:1,children:a("login.loacl")}),e(p,{variant:"body2",mb:3,children:a("login.now")}),e(he,{sx:{maxHeight:"300px",overflowY:"auto",width:{md:"80%",sm:"100%"}},children:m?m.map(c=>h(se,{sx:{mb:2,p:0},children:[e(de,{title:c.name,placement:"bottom-start",children:e(p,{width:"60%",variant:"body2",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"},children:c.name})}),c.isLogin?e(y,{disabled:c.isLogin,variant:"text",sx:{mx:1,minWidth:150},size:"large",children:a("manage.current")}):c.isShow?e(y,{variant:"outlined",sx:{mx:1,minWidth:150},onClick:()=>{$(c.id)},size:"large",children:a("manage.close")}):e(y,{sx:{mx:1,minWidth:150},variant:"filled",onClick:()=>{T(c.id)},size:"large",children:a("manage.use")})]},c.id)):""}),v?e(B,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:1},children:h(M,{direction:"row",children:[e(X,{sx:{width:"60%"},placeholder:a("home.inputAccount"),size:"medium",fullWidth:!0,autoComplete:"off",value:x,variant:"standard",onChange:k,error:f?f.boo:!1,helperText:f?f.text:""}),e(y,{variant:"outlined",sx:{mx:1,minWidth:150},onClick:w,size:"large",children:a("login.confirm")})]})}):"",e(D,{children:e(y,{variant:"filled",sx:{mx:1,minWidth:150},onClick:I,size:"large",children:a("manage.add")})}),e(oe,{open:d,autoHideDuration:3e3,onClose:z,anchorOrigin:{vertical:"top",horizontal:"center"},children:e(q,{onClose:z,severity:"warning",sx:{width:"100%"},children:a("manage.create")})})]})},Pe=window,Se=()=>{const{i18n:a}=F(),m=pe(),n=fe(we),t=async s=>{a.changeLanguage(s.value),await m(be(s.value)),await m(Ce(s.value)),localStorage.setItem("lang",s.value),Pe.location.reload()};return e(re,{children:e(ue,{freeSolo:!0,id:"language-change",sx:{width:300},size:"medium",value:G.find(s=>s.value===n),options:G,getOptionLabel:s=>s.label,onChange:(s,d)=>{t(d)},disableClearable:!0,clearIcon:"",renderInput:s=>{var d;return e(X,{variant:"outlined",className:"team-search",...s,InputProps:{...s.InputProps,type:"search",startAdornment:e(R,{position:"start",children:e(J,{alt:"Remy Sharp",src:(d=G.find(S=>S.value===n))==null?void 0:d.logo,sx:{width:25,height:25}})})}})},renderOption:(s,d)=>h(se,{...s,children:[n===d.value?e(me,{color:"success"}):e(p,{fontSize:20,width:20}),e(J,{alt:"Remy Sharp",src:d.logo,sx:{width:25,height:25}}),e(ge,{primary:d.label,sx:{ml:1}})]})})})},ke=(a,m)=>{const{t:n}=F(),{success:t}=a,[s,d]=r.useState(null),[S,v]=r.useState(null),[A,x]=r.useState(""),[C,f]=r.useState(null),[P,W]=r.useState(""),[k,I]=r.useState(null),[w,z]=r.useState(""),[$,T]=r.useState(null),c=r.useCallback(l=>{if(l.trim().length<=0){const b={text:n("manage.oldPassword"),boo:!0};return f(b),!1}else if(l!==(s==null?void 0:s.password)){const b={text:n("manage.oldError"),boo:!0};return f(b),!1}else return f({text:"",boo:!1}),!0},[s==null?void 0:s.password,n]),u=l=>{const{value:o}=l.target;c(o),x(o)},g=r.useCallback(l=>{const o=l.trim();if(o.length<=0){const b={text:n("manage.inputPassword"),boo:!0};return I(b),!1}else if(o.length>50){const b={text:n("manage.longPassword"),boo:!0};return I(b),!1}else return I({text:"",boo:!1}),!0},[n]),O=l=>{const{value:o}=l.target;g(o),W(o)},H=r.useCallback(l=>{if(l.trim().length<=0){const b={text:n("manage.againPassword"),boo:!0};return T(b),!1}else if(l!==P){const b={text:n("manage.againNot"),boo:!0};return T(b),!1}else return T({text:"",boo:!1}),!0},[P,n]),N=l=>{const{value:o}=l.target;H(o),z(o)},E=()=>{x(""),W(""),z(""),T(null),I(null),f(null)};r.useImperativeHandle(m,()=>({handleCancel:E}));const L=()=>{const l=c(A),o=g(P),b=H(w),Z=i.getCache("accountList");if(l&&o&&b){d({...s,password:w});const le=Z.map(K=>(K.id===s.selectId&&(K.password=w),K));if(i.setCache("accountList",le),i.setCache("current",{...s,password:w}),S){const K=S.map(j=>(j.privateKey&&(j.password=w),j));v(()=>[...K]),i.setCache(`${s.mnemonic}-${s.selectId}`,K)}t()}};return r.useEffect(()=>{(()=>{const o=i.getCache("current"),b=i.getCache(`${o.mnemonic}-${o.selectId}`);i.getCache("accountList");try{d(o),v(b)}catch{}})()},[]),h(D,{mb:3,children:[e(p,{variant:"h6",mb:1,children:n("manage.safety")}),e(p,{variant:"body2",mb:2,children:n("manage.setting")}),h(D,{sx:{width:{md:"80%",sm:"100%"}},children:[h(B,{fullWidth:!0,sx:{mb:2},children:[e(_,{htmlFor:"outlined-adornment-oldPassword",required:!0,sx:{fontSize:16},error:C?C.boo:!1,children:n("manage.check")}),e(V,{fullWidth:!0,placeholder:n("manage.old"),size:"medium",autoComplete:"off",type:"password",value:A,id:"outlined-adornment-oldPassword",onChange:u,startAdornment:e(R,{position:"start"}),label:n("manage.check"),error:C?C.boo:!1}),e(Y,{error:!0,children:C?C.text:""})]}),h(B,{fullWidth:!0,sx:{mb:2},children:[e(_,{htmlFor:"outlined-adornment-newPassword",required:!0,sx:{fontSize:16},error:k?k.boo:!1,children:n("manage.newPassword")}),e(V,{fullWidth:!0,placeholder:n("manage.new"),size:"medium",autoComplete:"off",type:"password",value:P,id:"outlined-adornment-newPassword",onChange:O,startAdornment:e(R,{position:"start"}),label:n("manage.newPassword"),error:k?k.boo:!1}),e(Y,{error:!0,children:k?k.text:""})]}),h(B,{fullWidth:!0,sx:{mb:2},children:[e(_,{htmlFor:"outlined-adornment-againPassword",required:!0,sx:{fontSize:16},error:$?$.boo:!1,children:n("manage.again")}),e(V,{fullWidth:!0,placeholder:n("manage.new"),size:"medium",autoComplete:"off",type:"password",value:w,id:"outlined-adornment-againPassword",onChange:N,startAdornment:e(R,{position:"start"}),label:n("manage.again"),error:$?$.boo:!1}),e(Y,{error:!0,children:$?$.text:""})]}),h(M,{direction:"row",justifyContent:"space-around",children:[e(y,{variant:"outlined",onClick:E,sx:{minWidth:150},size:"large",children:n("login.cancel")}),e(y,{variant:"filled",onClick:L,sx:{minWidth:150},size:"large",children:n("login.confirm")})]})]})]})},Ie=r.forwardRef(ke),U=window,ze=()=>{const{t:a}=F(),[m,n]=r.useState(!1),[t,s]=r.useState(null),[d,S]=r.useState(!1),[v,A]=r.useState(!1),[x,C]=r.useState(!1),[f,P]=r.useState("mnemonic"),[W,k]=r.useState(a("login.cody")),I=r.useRef(),w=()=>{n(!1),I.current&&I.current.handleCancel()},z=()=>{P("mnemonic"),!x&&!v&&C(!0),v&&A(!1)},$=()=>{C(!1)},T=()=>{P("private"),!x&&!d&&C(!0),d&&S(!1)},c=()=>{n(!0),k(a("manage.success")),U.location.reload()},u=()=>{const L="privateKey.txt",l=new Blob([t.privateKey],{type:"text/plain;charset=utf-8"});te.saveAs(l,L)},g=()=>{const L="mnemonic.txt",l=new Blob([t.mnemonic],{type:"text/plain;charset=utf-8"});te.saveAs(l,L)};r.useEffect(()=>{(()=>{const l=i.getCache("current");try{s(l)}catch{}})()},[]);const O=()=>{if(i.removeCacheToken("token"),i.removeCache("teamSelect"),t!=null&&t.mnemonic){const l=(i.getCache(`${t.mnemonic}-${t.selectId}`)||[]).map(o=>(o.index===0?o.isLogin=!0:o.isLogin=!1,o));i.setCache(`${t.mnemonic}-${t.selectId}`,l)}U.location.href="/login"},H=()=>{P("cleanAccount"),x||C(!0)},N=()=>{const l=(i.getCache("accountList")||[]).filter(o=>o.id!==t.selectId);i.setCache("accountList",l),i.removeCacheToken("token"),t!=null&&t.mnemonic&&i.removeCache(`${t.mnemonic}-${t.selectId}`),U.location.href="/login"},E=()=>{if(C(!1),f==="mnemonic")return A(!0),!1;if(f==="private")return S(!0),!1;f==="cleanAccount"&&N()};return h(xe,{children:[e(p,{variant:"h5",mb:3,children:a("nav.manage")}),t&&t.mnemonic?e(ye,{}):"",e(Ie,{ref:I,success:c}),t&&t.mnemonic?h(D,{mb:2,children:[e(p,{variant:"h6",mb:1,children:a("manage.phrase")}),e(p,{variant:"body2",mb:2,children:a("manage.custody")}),v?e(M,{direction:"row",children:h(q,{severity:"success",sx:{mb:2,display:"flex",alignItems:"center"},children:[t.mnemonic,e(Q,{"aria-label":"ContentCopyIcon",onClick:()=>{n(!0),i.copyToClipboard(t.mnemonic),k(a("login.cody"))},size:"medium",children:e(ee,{})})]})}):"",h(M,{direction:"row",children:[e(y,{variant:"filled",onClick:z,sx:{minWidth:150},size:"large",children:a(v?"manage.hide":"manage.show")}),v?e(y,{variant:"filled",onClick:g,sx:{mx:5,minWidth:150},size:"large",children:a("manage.import")}):""]})]}):"",h(D,{mb:2,children:[e(p,{variant:"h6",mb:1,children:a("manage.private")}),e(p,{variant:"body2",mb:2,children:a("manage.custodyKey")}),d?e(M,{direction:"row",children:h(q,{severity:"success",sx:{mb:2,display:"flex",alignItems:"center"},children:[t.privateKey,e(Q,{"aria-label":"ContentCopyIcon",onClick:()=>{n(!0),i.copyToClipboard(t.privateKey)},size:"medium",children:e(ee,{})})]})}):"",h(M,{direction:"row",children:[e(y,{variant:"filled",onClick:T,sx:{minWidth:150},size:"large",children:a(d?"manage.hidePrivate":"manage.showPrivate")}),d?e(y,{variant:"filled",onClick:u,sx:{mx:5,minWidth:150},size:"large",children:a("manage.import")}):""]})]}),h(D,{mb:3,children:[e(p,{variant:"h6",mb:2,children:a("manage.language")}),e(p,{variant:"body2",mb:2,children:a("manage.select")}),e(Se,{})]}),h(D,{mb:3,children:[e(p,{variant:"h6",mb:2,children:a("manage.help")}),e(p,{variant:"body2",mb:2,children:a("manage.user")})]}),h(D,{mb:3,children:[e(p,{variant:"h6",mb:2,children:a("manage.about")}),e(p,{variant:"body2",mb:2,children:a("manage.open")})]}),h(D,{mb:3,children:[e(y,{variant:"filled",sx:{mb:2,minWidth:150},onClick:H,size:"large",children:a("manage.clean")}),e(p,{variant:"body2",mb:2,children:a("manage.all")})]}),e(D,{mb:3,children:e(y,{variant:"filled",sx:{minWidth:150},onClick:O,size:"large",children:a("exit")})}),e(oe,{anchorOrigin:{vertical:"top",horizontal:"center"},open:m,onClose:w,autoHideDuration:2e3,children:e(q,{onClose:w,severity:"success",variant:"filled",sx:{width:"100%"},children:W})}),e(ve,{isCheck:x,close:$,confirm:E})]})};export{ze as Component};
