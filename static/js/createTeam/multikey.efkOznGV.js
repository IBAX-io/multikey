import{U as de,a6 as he,r as o,x as l,G as d,j as t,a2 as i,aI as p,b6 as v,aL as S,a3 as U,H,aD as V,bj as ue,bi as pe,a_ as be,a7 as w,ad as fe,ae as ge}from"../multikey/multikey.B-gp-w2q.js";import{a as h,u as ye,g as xe,b as Ce,d as ve,M as Se,e as _,t as we,f as ke}from"../multikey/multikey.DDolodBD.js";import{P as Ae}from"../multikey/multikey.fHI3YJvs.js";const ze=()=>{const k=h.getCache("current"),{t:a}=de(),I=he(),[b,G]=o.useState(""),[f,$]=o.useState(2),[s,A]=o.useState([k.account,"",""]),[g,D]=o.useState(null),[y,x]=o.useState(null),[c,N]=o.useState([]),[q,T]=o.useState(!1),[Z,J]=o.useState(""),[K,z]=o.useState(!1),[Q,j]=o.useState(!0),C=ye(xe),[W,R]=o.useState(!0),B=Ce(),P=o.useMemo(()=>[{jsonrpc:"2.0",method:"ibax.getBalance",id:1,params:[C.wallet,1]}],[C.wallet]),O=o.useCallback(async()=>{if(C.wallet){const r=await ve(P);if(r){const e=h.formatUnits(r[0].result.amount,r[0].result.digits);R(h.greaterThanZero(e,0))}}},[P,C.wallet]);o.useEffect(()=>{O()},[O]);const F=o.useCallback(r=>{const e=r.trim();if(e.length<=0){const n={text:a("home.inputName"),boo:!0};return D(n),!1}else if(e.length>20){const n={text:a("home.nameLength"),boo:!0};return D(n),!1}else return D({text:"",boo:!1}),!0},[a]),X=r=>{const{value:e}=r.target;G(e),F(e)},M=o.useCallback((r,e)=>{if(r.trim().length<=0)return N(()=>{const m={text:a("home.inputSign"),boo:!0};return c[e]=m,[...c]}),!1;if(h.validateAddress(r)){if(s.some((m,u)=>{if(u!==e)return m===r}))return N(()=>{const m={text:a("home.save"),boo:!0};return c[e]=m,[...c]}),!1;{const m={text:"",boo:!1};return c[e]=m,!0}}else return N(()=>{const m={text:a("home.addreeType"),boo:!0};return c[e]=m,[...c]}),!1},[c,s,a]),Y=(r,e)=>{A(()=>(s[e]=r,[...s])),M(r,e)},L=o.useCallback(r=>{const e=r?parseInt(String(r),10):0;if(e)if(e<2){const n={text:a("home.min"),boo:!0};return x(n),!1}else if(e>s.length){const n={text:a("home.limit",{num:s.length}),boo:!0};return x(n),!1}else return x({text:"",boo:!1}),!0;else{const n={text:a("home.inputNum"),boo:!0};return x(n),!1}},[s.length,a]),ee=r=>{const{value:e}=r.target,n=h.formatDecimalPlaces(e,0)?h.formatDecimalPlaces(e,0):"";$(n),L(n)},E=()=>{T(!1)},te=()=>{T(!1),s.length>=15?(T(!0),J(a("home.limit",{num:15}))):A(()=>(s.push(""),[...s]))},ae=r=>{A(()=>(s.splice(r,1),[...s]))},re=()=>{const r=F(b),e=L(String(f));s.map((u,me)=>M(u,me)).every(u=>u===!0)&&r&&e&&j(!1)},ne=()=>{z(!1)},se=o.useMemo(()=>({jsonrpc:"2.0",method:"ibax.getList",id:Date.now(),params:[{name:"@1wallets",where:`{'owners -> ${k.account}': 1}`,order:{id:1},offset:0,limit:10}]}),[k.account]),oe=async()=>{z(!1);const r=await B(_(se));if(_.fulfilled.match(r)&&(r.payload.list?r.payload.list:[]).length){const n=r.payload.list[0];B(we(n)),B(ke({id:n.id,changes:{isSelect:!0}}))}I("/",{replace:!0})},le=()=>{j(!0)},ie=()=>{z(!0)},ce=()=>{I("/",{replace:!0})};return l(Se,{children:[Q?l(d,{children:[t(i,{variant:"h5",mb:2,children:a("home.setting")}),t(i,{variant:"body1",mb:3,children:a("home.des")}),l("form",{autoComplete:"off",children:[l(p,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:3},children:[t(i,{variant:"body1",mb:2,children:a("home.team")}),t(i,{variant:"body2",mb:2,children:a("home.name")}),t(v,{placeholder:a("home.inputName"),size:"medium",fullWidth:!0,value:b,onChange:X,error:g?g.boo:!1}),t(S,{error:!0,children:g?g.text:""})]}),s.map((r,e)=>l(p,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:3},required:!0,children:[t(i,{variant:"body1",mb:2,children:a("home.sign",{num:e+1})}),e===0?l(U,{children:[t(v,{placeholder:a("home.inputSign"),size:"medium",fullWidth:!0,value:r,disabled:!0}),t(S,{error:!0})]}):l(U,{children:[l(H,{direction:"row",children:[t(v,{placeholder:a("home.inputSign"),size:"medium",fullWidth:!0,value:s[e]||"",onChange:n=>{const{value:m}=n.target;Y(m,e)},error:c[e]?c[e].boo:!1}),e>=3?t(V,{variant:"outlined",sx:{ml:1,minWidth:150,fontSize:12},onClick:()=>{ae(e)},size:"large",children:a("home.delete")}):""]}),t(S,{error:!0,children:c[e]?c[e].text:""})]})]},e)),t(p,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:3,mt:4},children:t(V,{variant:"outlined",startIcon:t(ue,{}),onClick:te,sx:{minWidth:150},size:"large",children:a("home.new")})}),l(p,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:1},children:[l(H,{direction:"row",spacing:3,mb:3,children:[t(i,{variant:"body1",mb:2,children:a("home.num")}),t(be,{title:a("home.signtip"),placement:"bottom",children:t(pe,{fontSize:"medium",sx:{cursor:"pointer"}})})]}),t(v,{placeholder:a("home.inputNum"),size:"medium",type:"InputNumber",sx:{width:60},value:f,onChange:ee,error:y?y.boo:!1}),t(i,{component:"span",variant:"body2",ml:1,children:a("home.over",{num:s.length})}),t(S,{error:!0,children:y?y.text:""})]}),t(p,{sx:{width:{md:"80%",sm:"100%"},display:"block",mb:1,mt:5,textAlign:"center"},children:l(H,{direction:"row",justifyContent:"space-around",children:[t(w,{sx:{minWidth:150},variant:"extended",onClick:ce,color:"primary",children:a("login.cancel")}),t(w,{sx:{minWidth:150},variant:"extended",onClick:re,color:"primary",children:a("home.continue")})]})})]})]}):l(d,{children:[t(i,{variant:"h5",mb:2,children:a("home.sure")}),t(i,{variant:"body1",mb:3,children:a("home.mistake")}),l(d,{display:"flex",mb:2,children:[l(i,{variant:"body1",children:[a("home.team"),":"]}),t(i,{variant:"body1",ml:.5,children:b})]}),t(i,{variant:"body1",mb:1,children:a("home.mulAddress")}),t(d,{mb:2,children:s.map((r,e)=>t(i,{variant:"body1",mb:1,children:r},e))}),t(i,{variant:"body1",mb:2,children:a("home.signAll",{num:f,length:s.length})}),l(d,{sx:{width:{md:"80%",sm:"100%"},display:"flex",justifyContent:"space-around",mb:1,mt:5,textAlign:"center"},children:[t(w,{variant:"extended",onClick:le,color:"primary",children:a("login.previous")}),l(d,{children:[t(w,{variant:"extended",onClick:ie,color:"primary",disabled:!W,children:a("home.build")}),W?"":t(i,{variant:"body2",color:r=>r.palette.error.light,mt:1,children:a("home.noGas")})]})]})]}),t(ge,{anchorOrigin:{vertical:"top",horizontal:"center"},open:q,onClose:E,autoHideDuration:3e3,children:t(fe,{onClose:E,severity:"error",variant:"filled",sx:{width:"100%"},children:Z})}),t(Ae,{isCheck:K,params:{contractName:"MultiSignCreateWallet",TeamName:b,Owners:s,Threshold:f},close:ne,confirm:oe})]})};export{ze as Component};
