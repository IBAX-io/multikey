import{J as K,r as m,V as Q,x as r,j as e,Y as _,bp as X,bq as Z,bu as ee,bs as $,bt as y,aS as B,M as t,a9 as d,O as p,ac as R,bv as ne,am as te,a4 as ae,ag as oe,b3 as re}from"../multikey/multikey.D1_AnZj2.js";import{u as ie,g as se,l as N,h as M,a as b,S as F,M as le}from"../multikey/multikey.DANc9zrZ.js";import{h as E,b as f}from"../multikey/multikey.CsbyK74s.js";const ce=()=>{const{t:o}=K(),[c,v]=m.useState(null),[i,w]=m.useState(null),[H,T]=m.useState(0),s=ie(se),q=Q(),S=m.useRef(1),[z,W]=m.useState(!1),[A,L]=m.useState(!1),x=10,h=m.useMemo(()=>({jsonrpc:"2.0",method:"ibax.getList",id:1,params:[{name:"@1multi_sign_proposals",where:`{"$or": ["wallet": "${s.wallet}", "$and": [{"to":"${s.wallet}"},{"status": "finished"}]]}`,offset:0,limit:x,order:{id:-1}}]}),[s.wallet]),[D,O]=m.useState(h.params[0].limit),j=m.useCallback(async()=>{const n=await N(h);if(n!=null&&n.list){const a=[];n.list.forEach(u=>{a.push({jsonrpc:"2.0",method:"ibax.ecosystemInfo",id:2,params:[Number(u.ecosystem)]})});const l=await M(a);w(l),v(n)}else w(null),v(null)},[h]);m.useEffect(()=>{s.wallet&&j()},[j,s.wallet]);const Y=async(n,a)=>{h.params[0].offset=a*h.params[0].limit,T(a);const l=await N(h);if(l){const u=[];l.list.forEach(P=>{u.push({jsonrpc:"2.0",method:"ibax.ecosystemInfo",id:2,params:[Number(P.ecosystem)]})});const C=await M(u);w(C),v(l)}},G=n=>{O(+n.target.value),T(0)},g=(n,a)=>{const l={...n,digits:a.digits,tokenSymbol:a.token_symbol,tokenName:a.token_name};q({pathname:"/message/details",search:`?${re(l)}`})},J=async n=>{if(z)return;const{target:a}=n,l=a,{scrollHeight:u,scrollTop:C,offsetHeight:P}=l;C+P>=u-25&&Math.ceil(c.count/x)>S.current&&!z&&(W(!0),S.current+=1,h.params[0].offset=(S.current-1)*x,setTimeout(async()=>{const k=await N(h);if(Math.ceil(c.count/x)>S.current?L(!0):L(!1),k){const I=[];k.list.forEach(V=>{I.push({jsonrpc:"2.0",method:"ibax.ecosystemInfo",id:2,params:[Number(V.ecosystem)]})});const U=await M(I);w(()=>[...i,...U]),v(()=>({count:k.count,list:[...c.list,...k.list]}))}W(!1)},500))};return r(le,{children:[e(p,{sx:{display:{xs:"none",sm:"none",md:"block"}},children:c?r(_,{children:[e(X,{sx:{minHeight:500},children:e(Z,{sx:{minWidth:650},stickyHeader:!0,"aria-label":"sticky table",children:e(ee,{children:c.list&&i?c.list.map((n,a)=>r($,{sx:{"& > *":{borderBottom:"unset"}},children:[e(y,{align:"left",width:200,children:e(B,{title:E(Number(n.created_at)*1e3),placement:"bottom",children:e(t,{variant:"body2",sx:{cursor:"pointer"},children:f(Number(n.created_at))<60?`${f(Number(n.created_at))} ${o("home.second")}`:f(Number(n.created_at))})})}),e(y,{align:"center",children:n.to===s.wallet?e(d,{direction:"row",children:r(p,{sx:{cursor:"pointer",color:l=>l.palette.primary.main,textDecoration:"underline"},onClick:()=>{g(n,i[a].result)},children:[e(t,{variant:"body2",component:"span",fontWeight:600,children:s.team_name}),e(t,{variant:"body2",component:"span",ml:1,children:o("home.achieve",{to:n.wallet})}),e(t,{variant:"body2",component:"span",ml:.5,children:b.formatFixed(n.amount,i[a].result.digits)}),e(t,{variant:"body2",component:"span",ml:.5,children:i[a].result.token_symbol})]})}):n.status==="ongoing"?e(d,{direction:"row",children:r(p,{sx:{cursor:"pointer",color:l=>l.palette.primary.main,textDecoration:"underline"},onClick:()=>{g(n,i[a].result)},children:[e(t,{variant:"body2",component:"span",fontWeight:600,children:s.team_name}),e(t,{variant:"body2",component:"span",ml:1,children:o("home.initiate")}),e(t,{variant:"body2",component:"span",ml:.5,children:b.formatFixed(n.amount,i[a].result.digits)}),r(t,{variant:"body2",component:"span",ml:.5,children:[i[a].result.token_symbol,","]}),e(t,{variant:"body2",component:"span",ml:1,children:o("home.wait")})]})}):n.status==="finished"?e(d,{direction:"row",children:r(p,{sx:{cursor:"pointer",color:l=>l.palette.primary.main,textDecoration:"underline"},onClick:()=>{g(n,i[a].result)},children:[e(t,{variant:"body2",component:"span",fontWeight:600,children:s.team_name}),e(t,{variant:"body2",component:"span",ml:1,children:o("home.initiate")}),e(t,{variant:"body2",component:"span",ml:.5,children:b.formatFixed(n.amount,i[a].result.digits)}),r(t,{variant:"body2",component:"span",ml:.5,children:[i[a].result.token_symbol,","]}),e(t,{variant:"body2",component:"span",ml:1,children:o("home.finish")})]})}):""}),r(y,{align:"center",children:[s.threshold,"/",s.owner_quantity]}),e(y,{align:"center",children:e(R,{variant:"outlined",onClick:()=>{g(n,i[a].result)},sx:{fontSize:12,minWidth:150,lineHeight:2.4},size:"large",children:o("home.examine")})})]},n.id)):e($,{sx:{"& > *":{borderBottom:"unset"}},children:e(y,{align:"center",colSpan:6,children:e(t,{variant:"body1",children:o("login.no")})})})})})}),c&&c.count?e(ne,{rowsPerPageOptions:[h.params[0].limit],component:"div",count:c.count,rowsPerPage:D,page:H,onPageChange:Y,onRowsPerPageChange:G}):e(F,{num:3})]}):e(t,{textAlign:"center",children:o("home.noMessage")})}),e(p,{sx:{display:{xs:"block",sm:"block",md:"none"}},width:"100%",children:c?r(te,{sx:{width:"100%",maxWidth:"100%",height:"80vh",overflowY:"auto",pb:5},onScroll:J,children:[c.list&&i?c.list.map((n,a)=>e(ae,{sx:{p:2,backgroundColor:l=>l.palette.surfaceContainer.main,borderRadius:5,mb:2,cursor:"pointer"},children:r(p,{width:"100%",children:[r(d,{direction:"row",justifyContent:"space-between",mb:.5,width:"100%",spacing:2,children:[r(d,{direction:"row",flexShrink:0,alignItems:"center",children:[r(t,{mr:1,variant:"body2",fontSize:12,children:[o("home.time"),":"]}),e(B,{title:E(Number(n.created_at)*1e3),placement:"bottom",children:e(t,{variant:"body2",sx:{cursor:"pointer"},children:f(Number(n.created_at))<60?`${f(Number(n.created_at))} ${o("home.second")}`:f(Number(n.created_at))})})]}),r(d,{direction:"row",flexShrink:0,alignItems:"center",children:[r(t,{mr:1,variant:"body2",fontSize:12,children:[o("home.signnum"),":"]}),r(t,{variant:"body2",sx:{cursor:"pointer"},children:[s.threshold,"/",s.owner_quantity]})]}),e(R,{variant:"outlined",onClick:()=>{g(n,i[a].result)},sx:{fontSize:12,minWidth:150,lineHeight:2.4},size:"large",children:o("home.examine")})]}),e(d,{direction:"row",justifyContent:"space-between",width:"100%",mb:1,children:e(d,{direction:"row",flexShrink:0,alignItems:"center",flexWrap:"wrap",sx:{wordBreak:"break-word"},children:n.status==="ongoing"?r(d,{direction:"row",flexWrap:"wrap",children:[e(t,{variant:"body2",component:"span",fontSize:12,children:s.team_name}),e(t,{variant:"body2",component:"span",ml:1,fontSize:12,children:o("home.initiate")}),e(t,{variant:"body2",component:"span",ml:.5,fontSize:12,children:b.formatFixed(n.amount,i[a].result.digits)}),e(t,{variant:"body2",component:"span",ml:.5,fontSize:12,children:i[a].result.token_symbol}),e(t,{variant:"body2",component:"span",ml:1,fontSize:12,children:o("home.wait")})]}):n.status==="finished"?r(d,{direction:"row",flexWrap:"wrap",children:[e(t,{variant:"body2",component:"span",fontSize:12,fontWeight:600,children:s.team_name}),e(t,{variant:"body2",component:"span",ml:1,fontSize:12,children:o("home.initiate")}),e(t,{variant:"body2",component:"span",ml:.5,fontSize:12,children:b.formatFixed(n.amount,i[a].result.digits)}),e(t,{variant:"body2",component:"span",ml:.5,fontSize:12,children:i[a].result.token_symbol}),e(t,{variant:"body2",component:"span",ml:1,fontSize:12,children:o("home.finish")})]}):""})}),n.to===s.wallet?r(d,{direction:"row",flexWrap:"wrap",children:[e(t,{variant:"body2",component:"span",sx:{fontWeight:600},fontSize:12,children:s.team_name}),e(t,{variant:"body2",component:"span",ml:1,fontSize:12,children:o("home.achieve",{to:n.to})}),e(t,{variant:"body2",component:"span",ml:.5,fontSize:12,children:b.formatFixed(n.amount,i[a].result.digits)}),e(t,{variant:"body2",component:"span",ml:.5,fontSize:12,children:i[a].result.token_symbol})]}):""]})},n.id)):e(F,{num:3}),e(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:z?r(_,{children:[e(oe,{size:20}),e(t,{variant:"body2",ml:2,children:o("nav.load")})]}):A?e(_,{children:e(t,{variant:"body2",ml:2,children:o("nav.drop")})}):e(_,{children:e(t,{variant:"body2",ml:2,children:o("nav.nomore")})})})]}):e(t,{variant:"body1",textAlign:"center",children:o("login.no")})})]})};ce.displayName="MessagePage";export{ce as Component};
