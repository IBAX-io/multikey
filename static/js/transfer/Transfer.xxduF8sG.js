import{U as ve,r as s,a6 as De,b4 as Ee,x as i,j as n,a2 as c,ag as I,ah as ee,H as y,$ as F,a0 as te,a3 as _e,a1 as Te,G as ae,aI as D,aZ as E,b6 as _,aY as S,aL as M,a_ as Pe,bi as ze,aD as ne}from"../.pnpm/.pnpm.B-gp-w2q.js";import{b as Fe,u as Me,g as $e,k as $,c as je,h as We,a as d,M as Be,i as He}from"../multikey/index.BlJOL7H-.js";import{P as re}from"../PasswordBox/PasswordBox.By85GjYI.js";const Le=[{label:"address",value:"address"},{label:"iName",value:"iName"}],Ue=window,Ve=()=>{const{t:r}=ve(),[C,se]=s.useState("address"),[e,oe]=s.useState(null),[w,T]=s.useState(""),[g,m]=s.useState(null),[N,j]=s.useState(""),[b,k]=s.useState(null),[h,W]=s.useState(""),[B,le]=s.useState(""),[ie,de]=s.useState(0),[me,ue]=s.useState(1),[x,A]=s.useState(null),[P,H]=s.useState(""),[L,z]=s.useState(!1),[u,ce]=s.useState([]),U=De(),he=Fe(),v=Me($e),{id:p,keyId:f,tokenSymbol:R}=Ee(),[pe,ge]=s.useState(p),[be,q]=s.useState(r("home.recipient")),xe=s.useMemo(()=>({jsonrpc:"2.0",method:"ibax.getList",id:1,params:[{name:"@1multi_sign_proposals",where:`{"wallet": ${v.wallet},"status": "ongoing"}`,limit:10,columns:"id"}]}),[v.wallet]),G=s.useMemo(()=>[{jsonrpc:"2.0",method:"ibax.getBalance",id:1,params:[$.addressString(f),Number(p)]}],[p,f]),V=s.useMemo(()=>({jsonrpc:"2.0",method:"ibax.getList",id:1,params:[{name:"@1ecosystems",where:`{id:${p}}`}]}),[p]),Z=s.useCallback(async()=>{const t=await je(V);if(t&&t.list){const a=t.list[0];if(a.fee_mode_info!=="NULL"){const o=JSON.parse(a.fee_mode_info);Number(o.fee_mode_detail.expedite_fee.flag)===2&&(ue(Number(o.fee_mode_detail.expedite_fee.flag)),de(Number(o.follow_fuel)))}}},[V]),O=s.useCallback(async()=>{const t=await We(G);if(t&&t[0].result){const a=t[0].result;oe(a)}},[G]);s.useEffect(()=>{O(),Z()},[O,Z]);const J=s.useCallback(t=>{const a=t.trim(),o=/^[\w]{4,20}$/;if(C==="address")if(a.length<=0){const l={text:r("home.recipient"),boo:!0};return m(l),!1}else{if(d.validateAddress(t))return m({text:"",boo:!1}),!0;{const l={text:r("home.addreeType"),boo:!0};return m(l),!1}}else if(a.length<=0){const l={text:r("home.iName"),boo:!0};return m(l),!1}else{if(o.test(t))return m({text:"",boo:!1}),!0;{const l={text:r("home.nickname"),boo:!0};return m(l),!1}}},[r,C]),fe=t=>{const{value:a}=t.target;T(a),J(a)},X=s.useCallback(t=>{const a=d.formatUnits(e==null?void 0:e.amount,e==null?void 0:e.digits);if(Number(t)<=0){const o={text:r("home.maxZero"),boo:!0};return k(o),!1}else if(d.comparedTo(t,a)){const o={text:r("home.maxAmount",{num:a,tokenSymbol:e==null?void 0:e.token_symbol}),boo:!0};return k(o),!1}else return k({text:"",boo:!1}),!0},[e==null?void 0:e.amount,e==null?void 0:e.digits,e==null?void 0:e.token_symbol,r]),ye=t=>{const{value:a}=t.target;Number(a)>=0&&(j(d.formatDecimalPlaces(a,e.digits)),X(a))},Y=s.useCallback(t=>{const a=d.formatUnits(e==null?void 0:e.amount,e==null?void 0:e.digits);if(t.trim().length>0)if(Number(t)<=0){const l={text:r("home.maxZero"),boo:!0};return A(l),!1}else if(d.comparedTo(t,a)){const l={text:r("home.maxAmount",{num:a,tokenSymbol:e==null?void 0:e.token_symbol}),boo:!0};return A(l),!1}else return A({text:"",boo:!1}),!0;else return!0},[e==null?void 0:e.amount,e==null?void 0:e.digits,e==null?void 0:e.token_symbol,r]),Se=t=>{const{value:a}=t.target;if(Number(a)>=0){W(d.formatDecimalPlaces(a,e.digits));const o=d.formatFixed(Number(a)/(ie*10**e.digits),0);le(o),Y(a)}},Ce=t=>{const{value:a}=t.target;H(a)},we=()=>{const t=J(w),a=X(N),o=Y(h);t&&a&&o&&z(!0)},Ne=()=>{T(""),j(""),W(""),H(""),m(null),k(null),A(null)},K=()=>{z(!1)},Q=async()=>{z(!1),await he(He(xe)),U("/",{replace:!0})},ke=async t=>{const{value:a}=t.target,o={text:"",boo:!1};T(""),m(o),se(t.target.value),q(r(a==="address"?"home.recipient":"home.iName"))},Ae=async t=>{const a=t.target.value,o=u==null?void 0:u.find(l=>Number(l.id)===Number(a));ge(a),U(`/transfer/${o==null?void 0:o.tokenSymbol}/${a}/${f}`,{replace:!0}),Ue.location.reload()};return s.useEffect(()=>{(()=>{const a=d.getCache(`${v.wallet}-all`)||[];a.length&&ce(a)})()},[v.wallet]),i(Be,{children:[n(c,{variant:"h5",mb:3,children:r("home.transfer")}),n(y,{textAlign:"center",direction:"row",justifyContent:"center",children:u&&(u!=null&&u.length)?n(I,{sx:{"& fieldset":{border:"none"},"& .MuiInputBase-input.MuiSelect-select":{display:"flex",alignItems:"center",backgroundColor:t=>t.palette.onBody.main},"& .MuiTypography-root":{mr:1}},size:"medium",MenuProps:{style:{maxHeight:400}},labelId:"token-simple-select-label",id:"token-simple-select",value:pe,onChange:Ae,children:u.map(t=>n(ee,{value:t.id,sx:{mb:1},children:i(y,{flexGrow:0,direction:"row",alignItems:"center",children:[t.id===1?n(F,{src:"/logo-big.png",sx:{width:30,height:30},children:n(te,{})}):n(_e,{children:t.logoURI?n(F,{src:t.logoURI,sx:{width:30,height:30}}):n(F,{sx:{width:30,height:30},children:n(te,{fontSize:"medium"})})}),n(Te,{primary:`${t.tokenSymbol}#${t.id}`,sx:{ml:1}})]})},t.id))}):""}),i(y,{textAlign:"center",direction:"row",justifyContent:"center",mb:2,children:[i(c,{variant:"h6",children:[r("home.balance"),":"]}),n(c,{variant:"h6",ml:1,children:d.formatFixed(e==null?void 0:e.amount,e==null?void 0:e.digits)}),n(c,{variant:"h6",ml:1,children:R})]}),n(ae,{display:"flex",justifyContent:"center",children:i(ae,{sx:{width:{md:"40%",sm:"100%"}},children:[i(D,{fullWidth:!0,sx:{mb:2},children:[n(E,{variant:"outlined",htmlFor:"outlined-adornment-address",required:!0,sx:{fontSize:16},error:g?g.boo:!1,children:r("home.send")}),n(_,{fullWidth:!0,placeholder:be,size:"medium",autoComplete:"off",value:w,id:"outlined-adornment-address",onChange:fe,startAdornment:n(S,{position:"start"}),sx:{paddingRight:0},endAdornment:n(S,{position:"end",children:n(I,{labelId:"lang-select-helper-label",id:"type-select-helper",value:C,size:"medium",placeholder:"",onChange:ke,inputProps:{name:"languages",id:"uncontrolled-native"},sx:{border:"none",":before":{borderColor:"divider"},bgcolor:"secondary.light",fontStyle:"italic"},children:Le.map(({value:t,label:a})=>n(ee,{value:t,sx:{mt:1},children:a},t))})}),label:r("home.send"),error:g?g.boo:!1}),n(M,{error:!0,children:g?g.text:""})]}),i(D,{fullWidth:!0,sx:{mb:2},children:[n(E,{htmlFor:"outlined-adornment-count",required:!0,sx:{fontSize:16},error:b?b.boo:!1,children:r("home.count")}),n(_,{id:"outlined-adornment-count",placeholder:r("home.dir"),type:"InputNumber",autoComplete:"off",size:"medium",fullWidth:!0,value:N,onChange:ye,startAdornment:n(S,{position:"start"}),label:r("home.count"),error:b?b.boo:!1}),n(M,{error:!0,children:b?b.text:""})]}),i(D,{fullWidth:!0,sx:{mb:2},children:[n(E,{htmlFor:"outlined-adornment-comment",sx:{fontSize:16},children:r("home.comment")}),n(_,{id:"outlined-adornment-comment",placeholder:r("home.commentInput"),fullWidth:!0,multiline:!0,autoComplete:"off",minRows:2,maxRows:2,value:P,onChange:Ce,startAdornment:n(S,{position:"start"}),label:r("home.comment"),inputProps:{maxLength:150}})]}),i(D,{fullWidth:!0,sx:{mb:2},children:[n(E,{htmlFor:"outlined-adornment-expedit",sx:{fontSize:16},error:x?x.boo:!1,children:r("home.expedit")}),n(_,{id:"outlined-adornment-expedit",placeholder:r("home.expeditInput"),type:"InputNumber",size:"medium",autoComplete:"off",fullWidth:!0,value:h,onChange:Se,startAdornment:n(S,{position:"start"}),label:r("home.expedit"),error:x?x.boo:!1}),n(M,{error:!0,children:x?x.text:""})]}),me===2&&Number(B)!==0?i(y,{direction:"row",mb:3,alignItems:"center",children:[i(c,{mr:.5,variant:"body2",children:[r("home.expedited"),":"]}),i(c,{variant:"body2",children:[h," ",R]}),n(c,{mx:.5,children:"â‰ˆ"}),i(c,{variant:"body2",mr:1,children:[B," IBXC"]}),n(Pe,{title:r("user.urgentpay"),placement:"bottom",children:n(ze,{fontSize:"medium",sx:{cursor:"pointer"}})})]}):"",i(y,{direction:"row",justifyContent:"space-around",children:[n(ne,{variant:"outlined",onClick:Ne,sx:{width:"40%"},size:"large",children:r("login.cancel")}),n(ne,{variant:"filled",onClick:we,sx:{width:"40%"},size:"large",children:r("login.confirm")})]})]})}),C==="address"?n(re,{isCheck:L,params:{contractName:"MultiSignPropose",Wallet:$.addressString(f),To:w,Amount:d.parseUnits(N,Number(e==null?void 0:e.digits)),digits:Number(e==null?void 0:e.digits),Ecosystem:p,Expedite:String(h)?String(h):"0",Proposal:P},close:K,confirm:Q}):n(re,{isCheck:L,params:{contractName:"MultiSignPropose",Wallet:$.addressString(f),iName:w,Amount:d.parseUnits(N,Number(e==null?void 0:e.digits)),digits:Number(e==null?void 0:e.digits),Ecosystem:p,Expedite:String(h)?String(h):"0",Proposal:P},close:K,confirm:Q})]})};export{Ve as Component};
