import{U as ce,r as s,a6 as he,b4 as G,x as l,j as r,a2 as i,H as y,G as O,aI as S,aZ as A,b6 as k,aY as N,aL as E,a_ as pe,bi as be,ad as $}from"../multikey/multikey.Cv6HG7AM.js";import{b as xe,u as fe,g as ge,k as F,h as Ce,c as ye,a as m,M as Se,i as Ae}from"../multikey/multikey.EJ3kMsQf.js";import{P as ke}from"../multikey/multikey.Cqi5RVD9.js";const Ne=()=>{const{t:n}=ce(),[e,J]=s.useState(null),[d,b]=s.useState(null),[u,x]=s.useState(null),[p,P]=s.useState(""),[j,X]=s.useState(""),[Y,K]=s.useState(0),[Q,I]=s.useState(1),[c,f]=s.useState(null),[T,W]=s.useState(""),[ee,w]=s.useState(!1),te=he(),ae=xe(),z=fe(ge),{id:h,keyId:g,tokenSymbol:_}=G(),[v,H]=s.useState(F.addressString(g)),[D,B]=s.useState(G().amount),ne=s.useMemo(()=>({jsonrpc:"2.0",method:"ibax.getList",id:1,params:[{name:"@1multi_sign_proposals",where:`{"wallet": ${z.wallet},"status": "ongoing"}`,limit:10,columns:"id"}]}),[z.wallet]),M=s.useMemo(()=>[{jsonrpc:"2.0",method:"ibax.getBalance",id:1,params:[F.addressString(g),Number(h)]}],[h,g]),L=s.useCallback(async()=>{const t=await Ce(M);if(t&&t[0].result){const a=t[0].result;J(a)}},[M]),U=s.useMemo(()=>({jsonrpc:"2.0",method:"ibax.getList",id:1,params:[{name:"@1ecosystems",where:`{id:${h}}`}]}),[h]),q=s.useCallback(async()=>{const t=await ye(U);if(t&&t.list){const a=t.list[0];if(a.fee_mode_info){const o=JSON.parse(a.fee_mode_info);Number(o.fee_mode_detail.expedite_fee.flag)===2&&(I(Number(o.fee_mode_detail.expedite_fee.flag)),K(Number(o.follow_fuel)))}}},[U]);s.useEffect(()=>{L(),q()},[L,q]);const R=s.useCallback(t=>{if(t.trim().length<=0){const o={text:n("home.recipient"),boo:!0};return b(o),!1}else{if(m.validateAddress(t))return b({text:"",boo:!1}),!0;{const o={text:n("home.addreeType"),boo:!0};return b(o),!1}}},[n]),re=t=>{const{value:a}=t.target;H(a),R(a)},V=s.useCallback(t=>{const a=m.formatUnits(e==null?void 0:e.amount,e==null?void 0:e.digits);if(Number(t)<=0){const o={text:n("home.maxZero"),boo:!0};return x(o),!1}else if(m.comparedTo(t,a)){const o={text:n("home.maxAmount",{num:a,tokenSymbol:e==null?void 0:e.token_symbol}),boo:!0};return x(o),!1}else return x({text:"",boo:!1}),!0},[e==null?void 0:e.amount,e==null?void 0:e.digits,e==null?void 0:e.token_symbol,n]),se=t=>{const{value:a}=t.target;Number(a)>=0&&(B(m.formatDecimalPlaces(a,e.digits)),V(a))},Z=s.useCallback(t=>{const a=m.formatUnits(e==null?void 0:e.amount,e==null?void 0:e.digits);if(t.trim().length>0)if(Number(t)<=0){const C={text:n("home.maxZero"),boo:!0};return f(C),!1}else if(m.comparedTo(t,a)){const C={text:n("home.maxAmount",{num:a,tokenSymbol:e==null?void 0:e.token_symbol}),boo:!0};return f(C),!1}else return f({text:"",boo:!1}),!0;else return!0},[e==null?void 0:e.amount,e==null?void 0:e.digits,e==null?void 0:e.token_symbol,n]),oe=t=>{const{value:a}=t.target;if(Number(a)>=0){P(m.formatDecimalPlaces(a,e.digits));const o=m.formatFixed(Number(a)/(Y*10**e.digits),0);X(o),Z(a)}},le=t=>{const{value:a}=t.target;W(a)},ie=()=>{const t=R(v),a=V(D),o=Z(p);t&&a&&o&&w(!0)},me=()=>{H(""),B(""),P(""),W(""),b(null),x(null),f(null)},de=()=>{w(!1)},ue=async()=>{w(!1),await ae(Ae(ne)),te("/",{replace:!0})};return l(Se,{children:[r(i,{variant:"h5",mb:3,children:n("home.transfer")}),l(y,{textAlign:"center",direction:"row",justifyContent:"center",mb:2,children:[r(i,{variant:"h6",children:_}),l(i,{variant:"h6",ml:1,children:["# ",h]})]}),l(y,{textAlign:"center",direction:"row",justifyContent:"center",mb:2,children:[l(i,{variant:"h6",children:[n("home.balance"),":"]}),r(i,{variant:"h6",ml:1,children:m.formatFixed(e==null?void 0:e.amount,e==null?void 0:e.digits)}),r(i,{variant:"h6",ml:1,children:_})]}),r(O,{display:"flex",justifyContent:"center",children:l(O,{sx:{width:{md:"80%",sm:"100%"}},children:[l(S,{fullWidth:!0,sx:{mb:2},children:[r(A,{htmlFor:"outlined-adornment-address",required:!0,sx:{fontSize:16},error:d?d.boo:!1,children:n("home.send")}),r(k,{fullWidth:!0,disabled:!0,placeholder:n("home.recipient"),size:"medium",autoComplete:"off",value:v,id:"outlined-adornment-address",onChange:re,startAdornment:r(N,{position:"start"}),label:n("home.send"),error:d?d.boo:!1}),r(E,{error:!0,children:d?d.text:""})]}),l(S,{fullWidth:!0,sx:{mb:2},children:[r(A,{htmlFor:"outlined-adornment-count",required:!0,sx:{fontSize:16},error:u?u.boo:!1,children:n("home.count")}),r(k,{id:"outlined-adornment-count",placeholder:n("home.dir"),type:"InputNumber",autoComplete:"off",size:"medium",fullWidth:!0,value:D,onChange:se,startAdornment:r(N,{position:"start"}),label:n("home.count"),error:u?u.boo:!1}),r(E,{error:!0,children:u?u.text:""})]}),l(S,{fullWidth:!0,sx:{mb:2},children:[r(A,{htmlFor:"outlined-adornment-comment",sx:{fontSize:16},children:n("home.comment")}),r(k,{id:"outlined-adornment-comment",placeholder:n("home.commentInput"),fullWidth:!0,multiline:!0,autoComplete:"off",minRows:3,maxRows:5,value:T,onChange:le,startAdornment:r(N,{position:"start"}),label:n("home.comment"),inputProps:{maxLength:150}})]}),l(S,{fullWidth:!0,sx:{mb:2},children:[r(A,{htmlFor:"outlined-adornment-expedit",sx:{fontSize:16},error:c?c.boo:!1,children:n("home.expedit")}),r(k,{id:"outlined-adornment-expedit",placeholder:n("home.expeditInput"),type:"InputNumber",size:"medium",autoComplete:"off",fullWidth:!0,value:p,onChange:oe,startAdornment:r(N,{position:"start"}),label:n("home.expedit"),error:c?c.boo:!1}),r(E,{error:!0,children:c?c.text:""})]}),Q===2&&Number(j)!==0?l(y,{direction:"row",mb:3,alignItems:"center",children:[l(i,{mr:.5,variant:"body2",children:[n("home.expedited"),":"]}),l(i,{variant:"body2",children:[p," ",_]}),r(i,{mx:.5,children:"â‰ˆ"}),l(i,{variant:"body2",mr:1,children:[j," IBXC"]}),r(pe,{title:n("user.urgentpay"),placement:"bottom",children:r(be,{fontSize:"medium",sx:{cursor:"pointer"}})})]}):"",l(y,{direction:"row",justifyContent:"space-around",children:[r($,{variant:"outlined",onClick:me,sx:{minWidth:150,lineHeight:2.4},size:"large",children:n("login.cancel")}),r($,{variant:"filled",onClick:ie,sx:{minWidth:150,lineHeight:2.4},size:"large",children:n("login.confirm")})]})]})}),r(ke,{isCheck:ee,params:{contractName:"MultiSignPropose",Wallet:F.addressString(g),To:v,Amount:m.parseUnits(D,Number(e==null?void 0:e.digits)),digits:Number(e==null?void 0:e.digits),Ecosystem:h,Expedite:String(p)?String(p):"0",Proposal:T},close:de,confirm:ue})]})};Ne.displayName="CollectionPage";export{Ne as Component};
