import{J,r as o,b8 as Z,x as s,j as e,M as x,O as m,a9 as w,aa as G,U as K,b9 as X,av as Y,aR as ee,ba as te,$ as U,ay as ne,ac as v,bb as oe,bc as ae,bd as re,be as le,bf as se,bg as ie,bh as ce,bi as de,bj as ue,bk as he,bl as me,ae as be,af as pe}from"../multikey/multikey.D1_AnZj2.js";import{u as fe,g as ge,k as ye,h as Ce,M as xe,a as S}from"../multikey/multikey.DANc9zrZ.js";const we=()=>{const{t:a}=J(),b=window.location.protocol+"//"+window.location.host,[g,k]=o.useState(null),{id:i,keyId:u,tokenSymbol:p}=Z(),[l,$]=o.useState(b),[L,q]=o.useState(null),[h,D]=o.useState(""),[c,z]=o.useState(null),[H,y]=o.useState(!1),C=fe(ge),I=o.useCallback(()=>{$(`${b}/collection/${p}/${i}/${u}/${h||0}`)},[h,b,i,u,p]),A=o.useMemo(()=>[{jsonrpc:"2.0",method:"ibax.getBalance",id:1,params:[ye.addressString(u),Number(i)]}],[i,u]),B=o.useCallback(async()=>{const t=await Ce(A);if(t&&t[0].result){const n=t[0].result;q(n)}},[A]);o.useEffect(()=>{B()},[B]),o.useEffect(()=>{I()},[I]);const j=o.useCallback(t=>{if(Number(t)<0){const n={text:a("home.maxZero"),boo:!0};return z(n),!1}else return z({text:"",boo:!1}),!0},[a]),O=t=>{const{value:n}=t.target;Number(n)>=0&&(D(S.formatDecimalPlaces(n,L.digits)),j(n)&&$(()=>`${b}/collection/${p}/${i}/${u}/${h}`))},R=()=>{y(!1)},Q=()=>{y(!0),S.copyToClipboard(l)},F=t=>{const n=t.split(","),r=n[0].match(/:(.*?);/)[1],f=atob(n[1]);let d=f.length;const E=new Uint8Array(d);for(;d--;)E[d]=f.charCodeAt(d);return new Blob([E],{type:r})},N=(t,n)=>{const r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download",n),r.setAttribute("target","_blank"),r.dispatchEvent(new MouseEvent("click"))},W=()=>{if(j(h)){const r=document.getElementById("qrCode").toDataURL("image/png"),f=F(r),d=URL.createObjectURL(f);N(d,"qrCode")}},M=()=>{S.copyToClipboard(C.wallet),y(!0)},P=t=>{k(g?null:t.currentTarget)},T=!!g,V=T?"simple-popper":void 0,_=()=>{k(null)};return s(xe,{children:[e(x,{variant:"h5",mb:3,children:a("home.receive")}),s(m,{sx:{width:{md:"80%",sm:"100%"}},textAlign:"center",m:"auto",mb:2,children:[e(x,{variant:"body1",mb:1,children:C.team_name}),s(w,{direction:"row",justifyContent:"center",alignItems:"center",children:[e(x,{variant:"body1",children:C.wallet}),e(K,{"aria-label":"ContentCopyIcon",onClick:M,size:"medium",color:"primary",children:e(G,{fontSize:"medium"})})]})]}),e(w,{direction:"row",justifyContent:"center",alignItems:"center",mb:3,children:e(m,{children:e(X,{id:"qrCode",value:l,size:128,imageSettings:{excavate:!0,src:"",width:30,height:30}})})}),e(m,{display:"flex",justifyContent:"center",children:s(m,{sx:{width:{md:"80%",sm:"100%"}},children:[s(Y,{fullWidth:!0,sx:{mb:2},children:[e(ee,{htmlFor:"outlined-adornment-count",required:!0,sx:{fontSize:16},error:c?c.boo:!1,children:a("home.count")}),e(te,{id:"outlined-adornment-count",placeholder:a("home.collection"),type:"InputNumber",autoComplete:"off",size:"medium",fullWidth:!0,value:h,onChange:O,startAdornment:e(U,{position:"start"}),endAdornment:e(U,{position:"end",children:p}),label:a("home.count"),error:c?c.boo:!1}),e(ne,{error:!0,children:c?c.text:""})]}),s(w,{direction:"row",justifyContent:"space-between",flexWrap:"wrap",children:[e(v,{color:"primary",variant:"filled",size:"large",onClick:W,sx:{fontSize:12,px:2,minWidth:120,lineHeight:2.4,height:52},children:a("home.saveqr")}),e(v,{color:"primary",variant:"filled",size:"large",onClick:Q,sx:{fontSize:12,px:2,minWidth:120,lineHeight:2.4,height:52},children:a("home.cody")}),e(v,{color:"primary",variant:"filled",size:"large",sx:{fontSize:12,px:2,minWidth:120,lineHeight:2.4,height:52},"aria-describedby":V,onClick:P,children:a("home.give")})]})]})}),e(me,{id:i,open:T,anchorEl:g,onClose:_,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:s(m,{p:2,display:"flex",width:200,justifyContent:"space-between",children:[e(oe,{url:l,children:e(ae,{size:30,round:!0})}),e(re,{url:l,children:e(le,{size:30,round:!0})}),e(se,{url:l,children:e(ie,{size:30,round:!0})}),e(ce,{url:l,children:e(de,{size:30,round:!0})}),e(ue,{url:l,children:e(he,{size:30,round:!0})})]})}),e(pe,{anchorOrigin:{vertical:"top",horizontal:"center"},open:H,onClose:R,autoHideDuration:2e3,children:e(be,{onClose:R,severity:"success",variant:"filled",sx:{width:"100%"},children:a("login.cody")})})]})};we.displayName="ReceivePage";export{we as Component};
